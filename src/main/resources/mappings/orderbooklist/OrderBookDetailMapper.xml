<?xml version="1.0" encoding="UTF-8" ?>
        <!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.base.sbc.module.orderbook.mapper.OrderBookDetailMapper">
    <select id="queryPage" resultType="com.base.sbc.module.orderbook.vo.OrderBookDetailVo">
        SELECT
        tobl.*,
        tob.name as orderBookName,
        ts.id as styleId,
        ts.design_no as style,
        ts.style_pic,
        ts.brand_name,
        ts.brand as brandCode,
        ts.prod_category_name as categoryName,
        ts.prod_category as categoryCode,
        ts.prod_category2nd_name,
        if(ts.brand_name ='PM',ts.positioning,null) as positioning,
        if(ts.brand_name ='PM',ts.positioning_name,null) as positioningName,
        ts.designer as styleDesignerName,
        tsc.style_color_pic,
        tsc.style_no as bulkStyleNo,
        ts.devt_type_name,
        tsc.band_name,
        tsc.band_code,
        tsc.color_name,
        tsc.color_code,
        tsc.supplier_abbreviation as fobClothingFactoryName,
        tsc.supplier_code as fobClothingFactoryCode,
        tsc.supplier as fobSupplier,
        tsc.tag_price,
        tsc.bom,
        tsc.bom_status,
        tsc.scm_send_flag,
        tbcl.colour_code as supplierColor,
        tpi.id as packInfoId
        FROM
        t_order_book_detail tobl
        left join t_style_color tsc on tobl.style_color_id = tsc.id and tsc.del_flag='0'
        left join t_style ts on ts.id = tsc.style_id and ts.del_flag='0'
        left join t_order_book tob on tob.id = tobl.order_book_id and tob.del_flag='0'
        left join t_basicsdatum_colour_library tbcl on tbcl.colour_code = tsc.color_code and tbcl.del_flag='0'
        LEFT JOIN t_pack_info tpi ON tsc.style_no = tpi.style_no
        where tobl.del_flag='0'
        <if test="ew.customSqlSegment != null and ew.customSqlSegment != ''">
            ${ ew.customSqlSegment.startsWith("WHERE")?ew.customSqlSegment.replace("WHERE","AND "):ew.customSqlSegment}
        </if>
    </select>
</mapper>